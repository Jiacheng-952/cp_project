{"id": "rail_scheduling_construction_001", "en_question": "# 施工维修期间列车运行图调度优化问题\n\n## 问题描述\n\n现有一个施工维修期间的列车运行图问题，需要在给定的时间范围内，为线路上的列车安排到达和离开各车站的时间。为保证列车在站内的作业时间，列车间的最小间隔时间需要大于一个指定的值，同时**列车不能在正在施工维修期间的区间内运行**。问题的目标是在满足列车停站需求和间隔时间的基础上，**最小化所有列车的旅行时间**。\n\n## 数据描述\n\n所需的数据都保存在\"data.xlsx\"中，下面为每个表的介绍：\n\n### 1. 车站信息（\"station\"工作表）\n\n第一列为车站名称，第二列为该站距起点的距离。各站仅一股道可用，同一时刻最多一列车停站或通过，且不允许越行。即列车必须在前车驶离后，方可进入车站。\n\n**数据格式：**\n| station | mile |\n| ------- | ---- |\n| A       | 0    |\n| B       | 50   |\n| ...     | ...  |\n\n### 2. 列车信息（\"train\"工作表）\n\n包括列车车次（trainNO列）、速度等级（speed列），以及在各站是否停站的标识（1为停站，0为通过。通过时到发时间相同，但仍占用股道）。所有列车均依次经过所有车站，单个列车的旅行时间为列车在终到站的到达时间减去列车在始发站的出发时间。\n\n**数据格式：**\n| trainNO | speed | A | B | C | ... |\n| ------- | ----- | - | - | - | --- |\n| G1      | 350   | 1 | 0 | 0 | ... |\n| G3      | 350   | 1 | 1 | 1 | ... |\n| ...     | ...   |...|...|...|...  |\n\n### 3. 区间运行时间（\"runtime\"工作表）\n\n第一列表示区间名称，由\"前站名-后站名\"组成，后续几列依次表示不同速度等级的列车在该区间上的运行时间，每列对应的速度等级为第一行的数值，从第二行开始是对应的区间运行时间。列车在前站的出发时间加上对应的区间运行时分应等于列车在后站的到达时间。**注意：速度等级列名为字符串格式（'300', '350'）**。\n\n**数据格式：**\n| station | '300' | '350' |\n| ------- | ----- | ----- |\n| A-B     | 10    | 9     |\n| B-C     | 20    | 18    |\n| ...     | ...   | ...   |\n\n### 4. 施工维修信息（\"maintenance\"工作表）\n\n第一列表示施工维修的区间名称，第二列表示施工维修开始的时间，第三列表示施工维修结束的时间。在区间进行施工维修的期间，**列车不能在区间内运行**。这意味着列车不能在施工时间窗口内进入或经过该区间。\n\n**数据格式：**\n| section | start_time | end_time |\n| ------- | ---------- | -------- |\n| A-B     | 20         | 40       |\n| C-D     | 60         | 80       |\n| ...     | ...        | ...      |\n\n**列名说明：**\n- section: 施工区间名称（格式为\"前站-后站\"）\n- start_time: 施工开始时间\n- end_time: 施工结束时间\n\n**施工约束说明：**\n对于任意列车，如果其在某区间的运行时间与该区间的施工时间有重叠，则不允许该列车在该时间段通过该区间。具体而言，设列车在前站的出发时间为t_dep，在后站的到达时间为t_arr，施工开始时间为t_start，施工结束时间为t_end，则需要满足以下条件之一：\n- 列车在施工开始前完全通过该区间：t_arr ≤ t_start\n- 列车在施工结束后才进入该区间：t_dep ≥ t_end\n\n### 5. 其他参数（\"parameter\"工作表）\n\n包括参数名和对应数值。**注意：该工作表为转置格式，第一行为参数名，第二行为对应数值**：\n\n**数据格式：**\n| T   | H | MINSTOP | MAXSTOP |\n| --- | - | ------- | ------- |\n| 160 | 5 | 2       | 15      |\n\n**参数说明：**\n- T: 时间上限，所有到发时间需在[0, T]范围内\n- H: 最小间隔时间，要求同一车站任意两列车的到发时间差均不小于H分钟\n- MINSTOP: 中间站的最小停站时间约束\n- MAXSTOP: 中间站的最大停站时间约束\n\n## 重要约束条件\n\n1. **时间范围**：列车的发车和到达时间均需要大于等于0，同时小于等于T分钟\n2. **间隔时间**：对于任意两列列车在任意车站，后车的到站时间减去前车的到站时间要大于等于H分钟，后车的出站时间减去前车的出站时间要大于等于H分钟\n3. **停站时间**：如果列车停站，除始发终到站外，其余车站列车停站时间最小为MINSTOP分钟，最大为MAXSTOP分钟\n4. **始发终到特殊处理**：在始发站列车的到站时间和出站时间相同，在终到站列车的出站时间和到站时间相同\n5. **运行时间约束**：列车在前站的出发时间加上对应的区间运行时分等于列车在后站的到达时间\n6. **不允许越行**：同一时刻最多一列车停站或通过\n7. **施工维修约束（关键）**：列车不能在施工维修期间通过正在施工的区间。对于每个施工区间，列车必须在施工开始前完全通过，或在施工结束后才进入\n\n## 目标函数\n\n最小化所有列车的总旅行时间，即：\n\n**minimize Σ(列车i在终点站的到达时间 - 列车i在始发站的出发时间)**\n\n其中i表示第i列列车。\n\n## 建模要求\n\n请基于以上说明，准确理解问题，界定参数与决策变量，分析约束条件，并建立相应的列车调度优化模型。注意写代码时，数据需要从数据文件中读取，不同的数据在不同的sheet里面。\n\n特别注意：施工维修约束是本问题的核心特征，需要确保列车的运行计划避开施工时间窗口。\n\n## 重要的数据读取提示\n\n在编写代码时，请特别注意以下实际的列名：\n- **station工作表**: 列名为 'station', 'mile'（车站名称和里程）\n- **train工作表**: 列名为 'trainNO', 'speed'，以及各车站名称作为列名（列车信息）\n- **runtime工作表**: 速度等级列名为字符串格式 '300', '350'（不是整数）\n- **maintenance工作表**: 列名为 'section', 'start_time', 'end_time'（施工维修信息）\n- **parameter工作表**: 列名为 'T', 'H', 'MINSTOP', 'MAXSTOP'，参数值在第一行\n\n请务必使用上述实际的列名来读取数据，以避免KeyError错误。", "en_answer": null, "type": "施工维修调度", "data_files": ["data.xlsx"]}





