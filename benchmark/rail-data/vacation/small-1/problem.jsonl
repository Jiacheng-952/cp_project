{"id": "rail_scheduling_vacation_001", "en_question": "# 节假日列车运行图编制优化问题\n\n## 问题描述\n\n现有一个节假日列车运行图编制问题，需要在给定的时间范围内，为线路上的列车安排到达和离开各车站的时间。为保证列车运行的作业时间，列车间的最小间隔时间需要大于一个指定的值。问题的目标是在满足列车停站的某种间隔时间的基础上，**最大化所有开行列车的价值**。请根据后续的输入数据，正确理解该问题，确定问题参数和决策变量，分析问题约束，建立该问题的列车调度优化模型。\n\n## 数据格式\n\n所需的数据都保存在\"data.xlsx\"中，下面为每个表的介绍：\n\n### 1. 车站数据\n\n（见Excel表格\"station\"工作表）。第一列表示车站名称，第二列表示当前车站与第一个车站的距离。每个车站只有一条股道能够接发列车，同一时间只允许一列列车在站内停留或通过，不允许列车越行。\n\n**数据格式：**\n| station | mile |\n| ------- | ---- |\n| A       | 0    |\n| B       | 50   |\n| C       | 100  |\n| ...     | ...  |\n\n**列名说明：**\n- station: 车站名称\n- mile: 该站距起点的距离\n\n### 2. 列车数据\n\n（见\"train\"工作表）。第一列表示列车车次，第二列表示列车速度标准，后续每列表示列车在该站是否停站，1表示列车停站；0表示列车不停站，直接通过该站，此时列车到达和离开车站的时间相同，但列车仍然会占用车站股道。无论是否停站，所有列车均会依次经过所有的车站，单个列车的旅行时间为列车在最后一个车站的到达时间减去列车在第一个车站的出发时间。列车的到发时间均需要大于等于0。\n\n**数据格式：**\n| trainNO | speed | A | B | C | D | E | F | G |\n| ------- | ----- | - | - | - | - | - | - | - |\n| G1      | 350   | 1 | 0 | 0 | 0 | 0 | 1 | 1 |\n| G3      | 350   | 1 | 1 | 1 | 0 | 1 | 0 | 1 |\n| ...     | ...   |...|...|...|...|...|...|...|\n\n**列名说明：**\n- trainNO: 列车车次\n- speed: 列车速度等级\n- A, B, C, ...: 各车站名称，值为1表示停站，0表示通过\n\n### 3. 区间运行时分\n\n（见\"runtime\"工作表）。第一列表示区间名称，由\"前站名-后站名\"组成，第二列表示速度等级为300的列车在该区间上的运行时间，第三列表示速度等级为350的列车在该区间上的运行时间。列车在前站的出发时间加上对应的区间运行时分应等于列车在后站的到达时间。\n\n**数据格式：**\n| station | '300' | '350' |\n| ------- | ----- | ----- |\n| A-B     | 10    | 9     |\n| B-C     | 20    | 18    |\n| C-D     | 14    | 12    |\n| ...     | ...   | ...   |\n\n**列名说明：**\n- station: 区间名称（格式为\"前站-后站\"）\n- '300': 速度等级为300的列车在该区间的运行时间（注意：列名为字符串）\n- '350': 速度等级为350的列车在该区间的运行时间（注意：列名为字符串）\n\n### 4. 时间间隔参数\n\n（见\"parameter\"工作表）。包括参数名和对应数值。$$T$$表示运行图时间上限，所有到发时间需在$$[0,T]$$范围内；$$H$$为最小间隔时间，即对于任意两列列车在任意车站，后车的到站时间减去前车的到站时间要大于等于$$H$$分钟，同时后车的出站时间减去前车的出站时间要大于等于$$H$$分钟。为简化计算，始发站到离时间相同，终到站离到时间相同。$$MINSTOP$$与$$MAXSTOP$$分别表示中间站的最小与最大停站时间约束，即如果列车停站，除始发终到站不需要考虑外，其余车站列车停站时间最小为$$MINSTOP$$分钟，最大为$$MAXSTOP$$分钟。\n\n**数据格式：**\n第一行为参数名（表头），第二行为对应的参数值。\n\n| T   | H | MINSTOP | MAXSTOP |\n| --- | - | ------- | ------- |\n| 160 | 5 | 2       | 15      |\n\n**参数说明：**\n- $$T$$: 时间上限，所有到发时间需在$$[0, T]$$范围内\n- $$H$$: 最小间隔时间，要求同一车站任意两列车的到发时间差均不小于$$H$$分钟\n- $$MINSTOP$$: 中间站的最小停站时间约束\n- $$MAXSTOP$$: 中间站的最大停站时间约束\n\n### 5. 列车价值\n\n（见\"value\"工作表）。在客流分布不均匀的铁路网中，在高需求走廊上运行的列车比在低需求走廊上运行的列车会承载更多的乘客。此外，单列列车的价值还受到其按期服务质量的影响，具体来说，我们考虑了实际出发时间与期望出发时间的偏差，以及出行过程中较长的等待时间对服务质量的影响，这些负面影响使得每列列车的价值略有不同，每列列车的开行价值由以下公式决定：\n\n$$c_r = P_r - (d_r + g_r) \\times \\alpha$$\n\n其中$$P_r$$是列车的固有价值，$$d_r$$是列车在始发站的出发时间的偏差惩罚，即列车在始发站的实际出发时间与期望出发时间的差值，$$g_r$$为停站时间惩罚，$$\\alpha$$为比例系数参数，值为1。\n\n**数据格式：**\n\"value\"工作表中第一列表示列车车次，第二列表示列车固有价值，第三列表示列车期望出发时间。\n\n| trainNO | value | expect |\n| ------- | ----- | ------ |\n| G1      | 109   | 49     |\n| G3      | 108   | 13     |\n| G5      | 96    | 15     |\n| ...     | ...   | ...    |\n\n**列名说明：**\n- trainNO: 列车车次\n- value: 列车固有价值 $$P_r$$\n- expect: 列车期望出发时间\n\n## 重要约束条件\n\n1. **时间范围**：列车的发车和到达时间均需要大于等于0，同时小于等于$$T$$分钟\n2. **间隔时间**：对于任意两列列车在任意车站，后车的到站时间减去前车的到站时间要大于等于$$H$$分钟，后车的出站时间减去前车的出站时间要大于等于$$H$$分钟\n3. **停站时间**：如果列车停站，除始发终到站外，其余车站列车停站时间最小为$$MINSTOP$$分钟，最大为$$MAXSTOP$$分钟\n4. **始发终到特殊处理**：在始发站列车的到站时间和出站时间相同，在终到站列车的出站时间和到站时间相同\n5. **运行时间约束**：列车在前站的出发时间加上对应的区间运行时分等于列车在后站的到达时间\n6. **不允许越行**：同一时间只允许一列列车在站内停留或通过\n\n## 目标函数\n\n最大化所有开行列车的总价值，即：\n\n$$\\max \\sum_{r} c_r = \\max \\sum_{r} \\left[ P_r - (d_r + g_r) \\times \\alpha \\right]$$\n\n其中 $$r$$ 表示列车索引。\n\n## 建模要求\n\n请基于以上说明，准确理解问题，界定参数与决策变量，分析约束条件，并建立相应的列车调度优化模型。注意写代码时，数据需要从数据文件中读取，不同的数据在不同的sheet里面。\n\n## 重要的数据读取提示\n\n在编写代码时，请特别注意以下实际的列名：\n- **station工作表**: 列名为 'station', 'mile'（车站名称和里程）\n- **train工作表**: 列名为 'trainNO', 'speed'，以及各车站名称作为列名（列车信息）\n- **runtime工作表**: 速度等级列名为字符串格式 '300', '350'（不是整数）\n- **parameter工作表**: 列名为 'T', 'H', 'MINSTOP', 'MAXSTOP'，参数值在第一行（已转置为正常格式）\n- **value工作表**: 列名为 'trainNO', 'value', 'expect'\n\n请务必使用上述实际的列名来读取数据，以避免KeyError错误。", "en_answer": 1351, "type": "节假日调度", "data_files": ["data.xlsx"]}
